generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// Represents a Telegram user participating in the system.
model User {
  id Int @id @default(autoincrement())

  /// User Solona Address
  solAddress String

  /// Optional username (Telegram handle)
  username String?

  /// last wallet connect time
  connectAt DateTime @default(now())

  /// All recorded IP addresses for the user
  ips IP[]
}

/// Stores user IP details and geo-location metadata for auditing or fraud prevention.
model IP {
  id Int @id @default(autoincrement())

  /// Telegram ID of the associated user
  userId Int

  /// Relation to the User entity
  user User @relation(fields: [userId], references: [id])

  /// IP address
  ip String

  /// Optional city of the IP
  city String?

  /// Optional region
  region String?

  /// Optional country
  country String?

  /// Optional lat/lng coordinates
  loc String?

  /// Optional ISP or organization info
  org String?

  /// Postal code (if available)
  postal String?

  /// Timezone (if available)
  timezone String?

  /// Any additional metadata
  info String

  /// When the IP record was created
  createdAt DateTime @default(now())
}
