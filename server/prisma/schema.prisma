generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// Represents a Telegram user participating in the system.
model User {
  id Int @id @default(autoincrement())

  /// User Solona Address
  solAddress String

  /// Optional username (Telegram handle)
  username String?

  /// last wallet connect time
  connectAt DateTime @default(now())

  project         project[]
  ProjectReferrel ProjectReferrel[]
  task            task[]
}


/// Represents a project submitted by a user.
model project {
  id              Int               @id @default(autoincrement()) // Unique project ID that store on database
  userId          Int // ID of the user who submitted the project
  user            User              @relation(fields: [userId], references: [id]) // Relation to the User entity
  slug            String            @unique
  name            String // Name of the project
  description     String // description of the project
  launchDate      DateTime // Launch Date of the project
  image           String // URL to the project's image/logo
  reward          String // how much reward the project offers
  isDelete        Boolean           @default(false) // Soft delete flag:: user can delete project from his profile
  createdAt       DateTime          @default(now()) // Timestamp when the project was created
  updatedAt       DateTime          @updatedAt // Timestamp when the project was last updated
  isVerified      Boolean           @default(false)
  ProjectReferrel ProjectReferrel[]
  task            task[]
}

/// Task For any project
model task {
  id        Int      @id @default(autoincrement()) // task uniuqe id
  projectId Int
  project   project  @relation(fields: [projectId], references: [id])
  userId    Int
  user      User     @relation(fields: [userId], references: [id])
  taskLabel String
  taskImg   String
  taskHref  String
  createdAt DateTime @default(now())
}

/// Project referrel model 
model ProjectReferrel {
  slug      String // project slug
  project   project  @relation(fields: [slug], references: [slug]) // Relation to the project entity
  userId    Int // Id of the user who made the referrel
  user      User     @relation(fields: [userId], references: [id]) // Relation to the user entity
  fingerprints String // IP address of the visitor who clicked the referrel link
  createdAt DateTime @default(now()) // Timestamp when the referrel was created

  @@unique([slug, userId, fingerprints])
}

/// Admin Panel Login model
model Admins {
  id        Int      @id @default(autoincrement())
  email     String   @unique // admin email 
  password  String // admin password
  createdAt DateTime @default(now()) // the time when the admin is created
  updatedAt DateTime @updatedAt
}
